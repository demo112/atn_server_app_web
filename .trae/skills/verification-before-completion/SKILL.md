---
name: verification-before-completion
description: "完成了吗、确认完成、验收、DoD、真的好了吗、证据、验证完成、完成前验证"
triggers:
  - 完成了吗
  - 确认完成
  - 验收
  - DoD
  - 真的好了吗
related_rules:
  - rules/14-definition-of-done
---

# 完成前验证

> 来源: [obra/superpowers](https://skills.sh/obra/superpowers/verification-before-completion)

声称工作完成却没有验证，是不诚实，不是效率。

**核心原则：证据先于声明，永远如此。**

违反这条规则的字面意思就是违反这条规则的精神。

---

## 铁律

### 没有新鲜验证证据，不能声称完成

如果你在这条消息中没有运行验证命令，你 **不能** 声称它通过了。

---

## 触发场景

**必须应用于：**

- 声称任何状态或表达满意之前
- 提交代码或创建 PR 之前
- 声称工作完成、修复、通过之前
- 任何"应该可以了"的时刻

---

## 门控流程

在声称任何状态之前：

```
1. 识别：什么命令能证明这个声明？
2. 运行：执行完整命令（新鲜的、完整的）
3. 阅读：完整输出，检查退出码，计数失败
4. 验证：输出是否确认声明？
   - 如果否：陈述实际状态和证据
   - 如果是：陈述声明并附带证据
5. 然后才能：做出声明
```

**跳过任何步骤 = 撒谎，不是验证**

---

## 常见失败

| 声明 | 需要 | 不充分 |
|------|------|--------|
| 测试通过 | 测试命令输出：0 failures | 之前的运行、"应该通过" |
| Linter 干净 | Linter 输出：0 errors | 部分检查、推断 |
| 构建成功 | 构建命令：exit 0 | Linter 通过、日志看起来正常 |
| Bug 已修复 | 测试原始症状：通过 | 代码改了、假设修好了 |
| 回归测试有效 | 红绿循环验证 | 测试通过一次 |
| Agent 完成 | VCS diff 显示变更 | Agent 报告"成功" |
| 需求满足 | 逐行检查清单 | 测试通过 |

---

## 红旗 - 停下来

如果你发现自己在想或说：

- "应该可以了"
- "我很有信心"
- "就这一次"
- "Linter 通过了"（但没运行编译器）
- "Agent 说成功了"
- "我累了"
- "部分检查就够了"
- "换个说法所以规则不适用"

**所有这些都意味着：停下来。运行验证命令。**

---

## 合理化借口预防

| 借口 | 现实 |
|------|------|
| "应该可以了" | 运行验证命令 |
| "我很有信心" | 信心 ≠ 证据 |
| "就这一次" | 没有例外 |
| "Linter 通过了" | Linter ≠ 编译器 |
| "Agent 说成功了" | 独立验证 |
| "我累了" | 疲惫 ≠ 借口 |
| "部分检查就够了" | 部分证明不了什么 |
| "换个说法所以规则不适用" | 精神重于字面 |

---

## 关键模式

### 测试

```
✅ [运行测试命令] [看到: 34/34 pass] "所有测试通过"
❌ "应该通过了" / "看起来正确"
```

### 回归测试（TDD 红绿）

```
✅ 写测试 → 运行(通过) → 撤销修复 → 运行(必须失败) → 恢复 → 运行(通过)
❌ "我写了回归测试"（没有红绿验证）
```

### 构建

```
✅ [运行构建] [看到: exit 0] "构建通过"
❌ "Linter 通过了"（linter 不检查编译）
```

### 需求

```
✅ 重读计划 → 创建检查清单 → 验证每项 → 报告差距或完成
❌ "测试通过，阶段完成"
```

### Agent 委托

```
✅ Agent 报告成功 → 检查 VCS diff → 验证变更 → 报告实际状态
❌ 信任 agent 报告
```

---

## 为什么这很重要

来自失败记忆：

- 声称"修好了"但没运行测试 → 实际上没修好
- 声称"构建通过"但只检查了 linter → 编译失败
- 声称"完成了"但没验证需求 → 遗漏功能
- 信任 agent 报告 → 实际上没完成

---

## 输出格式

### 验证报告

```markdown
## 验证报告

### 验证命令
{运行的命令}

### 输出
{命令输出}

### 结论
{基于证据的声明}
```

### 示例

```markdown
## 验证报告

### 验证命令
npm run build

### 输出
> attendance-system@1.0.0 build
> tsc && vite build

vite v5.0.0 building for production...
✓ 1234 modules transformed.
dist/index.html                  0.45 kB
dist/assets/index-abc123.js    234.56 kB

### 结论
构建成功，exit code 0
```

---

## 与其他 Skill 的关系

| Skill | 关系 |
|-------|------|
| systematic-debugging | 修复后需要本 Skill 验证 |
| problem-fixing | 修复后需要本 Skill 验证 |
| code-verification | 本 Skill 是其验证环节的强化 |
| git-operation | 提交前需要本 Skill 验证 |

---

## 底线

验证没有捷径。

运行命令。阅读输出。然后声称结果。

这是不可协商的。
