# Agent 清单

Agent是流程管理者，负责定义工作流程、调度Skill、管理状态、在关键节点请求人确认。

## Agent与Skill的关系

| 层级 | 角色 | 职责 | 类比 |
|------|------|------|------|
| 人 | 决策者 | 提需求、确认设计、验收结果 | 老板 |
| **Agent** | **流程管理者** | **定义工作流程、调度Skill** | **项目经理** |
| Skill | 执行者 | 执行具体步骤 | 操作手册 |
| Rules | 约束 | 全局规范 | 公司制度 |

## Agent清单

| Agent | 说明 | 文件 |
|-------|------|------|
| 开发Agent | 从需求到交付的完整开发流程（通用） | [dev-agent-prompt.md](./dev-agent-prompt.md) |

## Agent与业务领域Skill

Agent 是通用的流程管理者，不包含具体业务知识。业务领域知识通过 Skill 注入：

```
Agent (通用流程) + 业务领域Skill (业务知识) = 完整开发能力
```

| 业务领域 | Skill | 说明 |
|----------|-------|------|
| 考勤系统 | `attendance-domain` | 考勤概念、数据模型、业务规则 |

> 开发新业务系统时，创建对应的业务领域 Skill 即可复用 Agent。

## 流程总览

```
┌─────────────────────────────────────────────────────────────┐
│  阶段一：需求分析                                            │
│  → 🔴 人确认                                                │
├─────────────────────────────────────────────────────────────┤
│  阶段二：技术设计                                            │
│  → 🔴 人确认                                                │
├─────────────────────────────────────────────────────────────┤
│  阶段三：任务规划                                            │
├─────────────────────────────────────────────────────────────┤
│  阶段四：迭代实现                                            │
│  循环每个Task：实现→日志→验证→提交（失败则修复）              │
├─────────────────────────────────────────────────────────────┤
│  阶段五：集成测试                                            │
├─────────────────────────────────────────────────────────────┤
│  阶段六：交付                                                │
│  → 🔴 人确认                                                │
└─────────────────────────────────────────────────────────────┘
```

### Task执行循环

```
code-implementation → code-logging → code-verification → git-operation
                              ↑              ↓
                              └── problem-fixing ←┘（如验证失败）
```

## 人确认节点

| 节点 | 人需要确认什么 |
|------|---------------|
| 需求确认 | 需求文档是否准确 |
| 设计确认 | 设计方案是否合理 |
| 交付确认 | 功能是否符合预期 |
| 止损决策 | 回退/新思路/继续 |

## 止损机制

| 规则 | 说明 |
|------|------|
| 3次上限 | 同一问题同一思路最多尝试3次 |
| 范围限制 | 改动 > 3个文件触发止损 |
| 核心保护 | 涉及核心逻辑触发止损 |
| 人介入 | 止损触发后通知人决定 |
