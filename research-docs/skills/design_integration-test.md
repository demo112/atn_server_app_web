# Skill: integration-test 设计文档

## 一、基本信息

| 项目 | 内容 |
|------|------|
| 职责 | 执行集成测试，验证完整功能 |
| 输入 | 完整功能代码 + requirements.md |
| 输出 | 集成测试报告 |

---

## 二、设计讨论记录

### 2026-01-29 讨论

**与code-verification的区别：**
- code-verification：单个任务完成后，单元/模块级别
- integration-test：全部任务完成后，端到端级别

**测试设计原则：**
- 基于requirements.md的AC设计测试
- 覆盖正常和异常场景

---

## 三、方法论层

### 测试金字塔

```
        /\
       /  \  E2E（少）
      /----\
     /      \ 集成（中）
    /--------\
   /          \ 单元（多）
  --------------
```

integration-test 位于中间层。

### 测试场景设计

每个AC至少覆盖：
- 正常路径（Happy Path）
- 边界条件
- 异常情况

---

## 四、领域知识层

测试工具：
- API测试：Supertest
- E2E测试：Playwright/Cypress
- 数据准备：测试fixtures

---

## 五、操作指南层

### 流程

```
1. 读取requirements.md
   - 提取所有AC
   
2. 设计测试场景
   - 每个AC → 多个场景
   
3. 准备测试环境
   - 数据库初始化
   - 测试数据准备
   
4. 执行测试
   - 按场景执行
   - 记录结果
   
5. 输出测试报告
```

### AC到测试场景示例

```markdown
AC: 打卡成功显示时间和位置

场景1: 正常打卡
- 前置：用户已登录，有GPS权限
- 操作：点击打卡
- 预期：显示当前时间和位置

场景2: GPS获取失败
- 前置：用户已登录，GPS不可用
- 操作：点击打卡
- 预期：显示错误提示

场景3: 网络异常
- 前置：用户已登录，网络断开
- 操作：点击打卡
- 预期：显示网络错误提示
```

---

## 六、边界处理层

| 情况 | 处理 |
|------|------|
| 测试失败 | 输出报告，触发problem-fixing |
| 环境问题 | 记录，尝试修复 |
| AC不可自动测试 | 标记，建议人工验证 |
| 测试数据问题 | 重置数据，重试 |

---

## 七、SKILL.md 最终版

（设计完成后，提炼为正式的SKILL.md文件）
