# 止损机制讨论记录

## 问题背景

AI在增量修改时容易陷入"钻牛角尖"：
```
问题 → 改A → 引发B → 改B → 引发C → ...（越改越乱）
```

## 根本原因

1. 没有全局视角 - 只看局部，不看整体
2. 沉没成本心理 - 不愿承认之前方向错了
3. 缺乏止损机制 - 不知道什么时候该停下来重来

---

## 解决方案

### 核心机制

1. **修复次数上限** - 同一问题同一思路最多3次
2. **修复前评估** - 判断是局部问题还是设计问题
3. **检查点机制** - 每个稳定功能创建检查点，便于回退
4. **人介入决策** - 3次失败后通知人决定，而非自动回退

### 完整流程

```
收到反馈
    ↓
评估问题类型
    ├── 局部问题 → 增量修改
    │      ↓
    │   修复成功？ → 交付
    │      ↓ 失败
    │   已尝试3次？
    │      ├── 否 → 换思路再试（记录之前方案）
    │      └── 是 → 通知人，建议回退
    │                  ↓
    │              人决定：
    │              ├── 同意回退 → 回退到检查点，重新设计
    │              ├── 提供新思路 → 按新思路尝试
    │              └── 再试一次 → 继续
    │
    └── 设计问题 → 直接通知人，建议回退
```

---

## 自我反思与改进

### 问题1：3次上限是否合理？

- 3次是针对"同一问题的同一种解法"
- 换了思路，计数重置
- 可根据实际调整（2-5次）

### 问题2：如何判断"同一个问题"？

- 按"功能点"而非"错误信息"判断
- 例如："用户登录功能"是一个问题单元

### 问题3：回退后怎么"换思路"？

- 回退时先分析"之前为什么失败"
- 明确列出"之前尝试过的方案"，避免重复
- 人可以介入提供新方向

### 问题4：检查点的粒度

- 检查点 = 每个"可独立运行的功能"完成时
- 与提交粒度一致

### 问题5：人的介入时机

- 回退前通知人，而非自动回退
- 人可以选择：同意回退 / 提供新思路 / 再给一次机会

---

## 判断"设计问题"的标准

- 改动范围 > 3个文件
- 改动涉及核心逻辑
- 之前改过同类问题

满足任一条件 → 建议回退重新设计
