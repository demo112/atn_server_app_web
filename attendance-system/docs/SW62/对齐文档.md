# 对齐文档：SW62 考勤制度

## 1. 需求理解

**核心目标**：实现考勤系统的基础规则配置，当前主要关注「考勤日切换点」。

**背景**：
考勤系统需要支持跨天工作（如夜班），因此不能简单地按自然日（00:00-23:59）计算考勤。需要一个配置项（如 05:00）来划分考勤日。

## 2. User Stories

### Story 1: 初始化默认考勤设置
**As a** 系统运维/开发者,
**I want** 系统启动时自动初始化默认考勤设置,
**So that** 系统开箱即用，无需手动配置即可正常运行。

**验收标准 (AC)**：
- [ ] AC1: 数据库 `att_settings` 表为空时，自动插入默认记录
- [ ] AC2: 默认 `day_switch_time` 为 "05:00"

### Story 2: 获取考勤设置
**As a** 系统模块（如考勤计算服务）或 管理员,
**I want** 获取当前的考勤设置,
**So that** 能够正确计算考勤归属日期或查看当前规则。

**验收标准 (AC)**：
- [ ] AC1: 提供 GET `/api/v1/attendance/settings` 接口
- [ ] AC2: 返回当前生效的所有设置项（key-value）

### Story 3: 修改考勤设置
**As a** 管理员,
**I want** 修改考勤设置（如调整切换时间）,
**So that** 适应公司的考勤制度变化。

**验收标准 (AC)**：
- [ ] AC1: 提供 PUT `/api/v1/attendance/settings` 接口
- [ ] AC2: 验证输入格式（如时间格式 HH:mm）
- [ ] AC3: 修改成功后立即生效

## 3. 关键假设 (需确认)

1. **数据模型**：使用 Key-Value 结构的 `att_settings` 表存储，而不是单行多列。
   - 理由：Task Backlog 中提到 "key-value 结构"，且利于后续扩展其他配置项。
   - 结构示例：`key: string (PK), value: string, description: string`
2. **范围限制**：本次仅实现后端 API 和 Service，**不包含 Web 前端设置页面**。
   - 理由：Sprint 1 任务清单中 SW62 未包含 Web 任务。
3. **切换点格式**：`day_switch_time` 的值格式为 `HH:mm`（24小时制）。

## 4. 待确认问题

- Q1: 是否同意上述 KV 表结构设计？
- Q2: 确认本次 Sprint 不需要开发前端配置页面？
