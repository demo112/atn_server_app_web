# Requirements: 排班管理 (SW65)

## Overview

排班管理模块允许管理员为员工或部门分配班次，并以部门树的形式查看排班情况。这是考勤计算的基础，决定了员工每天的考勤规则。

## User Stories

### Story 1: 查看排班视图
As a 管理员, I want 以部门树结构查看人员排班, so that 我能直观了解各部门的排班情况

**Acceptance Criteria:**
- [ ] AC1: 左侧展示部门树，支持展开/折叠
- [ ] AC2: 点击部门，右侧展示该部门下人员的排班列表
- [ ] AC3: 支持按日期范围筛选排班记录
- [ ] AC4: 列表显示人员姓名、班次名称、生效日期范围

### Story 2: 人员排班
As a 管理员, I want 给指定人员分配班次, so that 设定其考勤规则

**Acceptance Criteria:**
- [ ] AC1: 选择人员、班次、生效日期范围（开始日期-结束日期）
- [ ] AC2: 校验日期范围内的排班冲突（同一天不能有两个班次）
- [ ] AC3: 提供“强制覆盖”选项。若勾选，则覆盖冲突的排班；若不勾选且有冲突，则报错提示
- [ ] AC4: 保存成功后，该人员在指定日期范围内应用该班次

### Story 3: 部门排班
As a 管理员, I want 给整个部门分配班次, so that 批量设定考勤规则

**Acceptance Criteria:**
- [ ] AC1: 选择部门、班次、生效日期范围
- [ ] AC2: 批量为该部门下所有有效人员创建排班记录
- [ ] AC3: 若某人员在此时段已有排班，根据“强制覆盖”选项处理：覆盖或跳过/报错
- [ ] AC4: 部门排班为一次性操作，后续新入职员工不自动继承该排班

### Story 4: 删除排班
As a 管理员, I want 删除错误的排班记录, so that 修正考勤规则

**Acceptance Criteria:**
- [ ] AC1: 支持删除指定人员的排班记录
- [ ] AC2: 删除后，该人员在该时间段内无排班（即无考勤要求或按默认规则）

## Constraints

- **排班冲突**: 同一人员在同一日期只能有一个有效班次。
- **有效期**: 排班必须有明确的开始日期和结束日期。
- **性能**: 部门排班可能涉及大量数据，需异步处理或批量优化。

## Out of Scope

- **自动排班**: 系统根据规则自动生成排班（高级功能）。
- **倒班/轮班**: 复杂的自动轮班规则（当前仅支持手动指定周期的班次）。
- **手机端排班**: 目前仅在 Web 管理端进行排班操作。

## Assumptions

以下假设已与用户确认：
- **排班粒度**: 以“天”为单位，不涉及跨天的小时级排班（跨天由班次定义解决）。
- **部门排班性质**: 是一次性批量操作，后续部门新入职员工**不会**自动继承该排班，需要单独排班。
- **冲突策略**: 默认报错提示冲突。提供“强制覆盖”选项，勾选后可覆盖旧排班。

## Metadata

- 规模: 中
- 涉及模块: attendance, user (read-only)
- 涉及端: Server, Web
- 状态: 已确认
