# Requirements: 人员管理增强功能 (SW74)

## Overview

在现有人员管理基础上，增加批量操作（删除、更换部门）和 Excel 导入导出功能，以提高管理员维护人员数据的效率。

## User Stories

### Story 1: 批量删除人员

As a 管理员, I want 批量删除选中的人员, so that 我可以快速清理无效的人员数据

**Acceptance Criteria:**

- [ ] AC1: 批量删除成功
  - **Given**: 管理员在列表中选中了 3 个有效人员
  - **When**: 点击"批量删除"按钮并确认
  - **Then**: 
    - 调用批量删除接口
    - 3 个被选中的人员状态变为 `deleted`
    - 关联的用户账号（如有）解除绑定
    - 列表自动刷新，不再显示这 3 个人员
    - 提示"删除成功"

- [ ] AC2: 批量删除确认
  - **Given**: 管理员选中了 N 个人员
  - **When**: 点击"批量删除"按钮
  - **Then**: 弹出确认框，提示"确定要删除选中的 N 名员工吗？此操作不可恢复。"

### Story 2: 批量更换部门

As a 管理员, I want 批量修改选中人员的部门, so that 我可以快速调整组织架构

**Acceptance Criteria:**

- [ ] AC1: 批量更换部门成功
  - **Given**: 管理员选中了 5 个人员，并选择了一个新部门 "研发部"
  - **When**: 确认更换
  - **Then**: 
    - 这 5 个人员的 `deptId` 更新为 "研发部" 的 ID
    - 列表刷新，人员部门显示为新部门
    - 提示"部门更换成功"

- [ ] AC2: 部门选择验证
  - **Given**: 管理员未选中任何人员
  - **When**: 尝试点击"更换部门"
  - **Then**: 按钮不可用或提示"请先选择人员"

### Story 3: Excel 导入人员

As a 管理员, I want 通过 Excel 批量导入人员, so that 我可以快速初始化或新增大量人员数据

**Acceptance Criteria:**

- [ ] AC1: 下载导入模板
  - **Given**: 管理员打开导入下拉菜单
  - **When**: 点击"下载模板"
  - **Then**: 浏览器下载一个 Excel 文件，包含表头：工号、姓名、手机号、邮箱、部门、入职日期

- [ ] AC2: 导入成功
  - **Given**: 管理员上传一个填写正确的 Excel 文件（包含 10 条新数据）
  - **When**: 点击"上传文件"并确认
  - **Then**: 
    - 系统解析 Excel
    - 创建 10 条新员工记录
    - 如果部门名称在系统中存在，自动关联；如果不存在，报错或提示
    - 提示"成功导入 10 条数据"
    - 列表刷新显示新数据

- [ ] AC3: 导入数据校验
  - **Given**: Excel 中包含重复的工号或手机号
  - **When**: 上传文件
  - **Then**: 
    - 导入失败，不创建任何数据（原子性）
    - 返回具体的错误信息（如：第 3 行工号已存在）

### Story 4: Excel 导出人员

As a 管理员, I want 将当前筛选的人员列表导出为 Excel, so that 我可以在本地进行数据备份或分析

**Acceptance Criteria:**

- [ ] AC1: 导出当前筛选结果
  - **Given**: 列表当前筛选了 "研发部" 的 "在职" 人员（共 50 人）
  - **When**: 点击"导出人员"
  - **Then**: 
    - 浏览器下载一个 Excel 文件
    - 文件包含 50 行数据
    - 包含字段：工号、姓名、部门、手机号、邮箱、状态、入职日期

## Constraints

- **性能**: 导入导出支持至少 1000 条数据
- **文件格式**: 仅支持 .xlsx 格式
- **原子性**: 批量操作（导入、删除、更新）需保证原子性，要么全成功，要么全失败（或部分成功但有详细报告，但在本期设计中优先采用事务原子性）

## Out of Scope

- 导入时自动创建不存在的部门（需先在部门管理中创建）
- 导出包含头像图片
