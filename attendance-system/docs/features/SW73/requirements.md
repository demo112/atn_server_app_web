# Requirements: 全公司考勤统计与日历视图

## Overview

在 App 端为管理员提供全公司的每日考勤统计功能，以便直观掌握公司出勤状况。同时，将个人考勤记录和公司统计统一采用日历视图（Calendar View）展示，提升用户体验和数据可视化的直观性。

## User Stories

### Story 1: 管理员查看全公司每日统计

As a 管理员, I want 在日历上查看全公司的每日考勤统计, so that 我能快速了解公司的整体出勤情况

**Acceptance Criteria:**

- [ ] AC1: 统计日历入口（管理员）
  - **Given**: 当前用户是管理员，已登录 App
  - **When**: 用户进入「考勤记录」页面
  - **Then**: 页面显示 Tab 切换：「个人记录」和「全公司统计」；默认显示「个人记录」

- [ ] AC2: 全公司统计日历展示
  - **Given**: 管理员切换到「全公司统计」Tab
  - **When**: 页面加载完成
  - **Then**: 
    - 显示当前月份的日历视图
    - 每天的格子内显示简要统计：出勤率（如 "95%"）或 异常人数（如 "异常: 3"）
    - 顶部显示当月累计数据（可选，如当月平均出勤率）

- [ ] AC3: 查看单日详细统计
  - **Given**: 管理员在「全公司统计」日历中
  - **When**: 点击某一个日期（如 2026-02-05）
  - **Then**: 
    - 弹出或在下方显示该日的详细统计卡片
    - 包含指标：应到人数、实到人数（打卡人数）、出勤率（百分比）、异常人数
    - 异常人数可点击（预留，本次不强制要求跳转到人员列表，但UI需预留）

- [ ] AC4: 权限控制
  - **Given**: 当前用户是普通员工（非管理员）
  - **When**: 用户进入「考勤记录」页面
  - **Then**: 不显示 Tab 切换，直接显示个人的考勤日历，无法查看全公司统计

### Story 2: 统一的日历视图（个人与公司）

As a 用户（员工/管理员）, I want 以日历形式查看考勤记录, so that 我能更直观地看到哪天有异常

**Acceptance Criteria:**

- [ ] AC1: 个人考勤日历视图
  - **Given**: 用户进入「考勤记录」页面（或「个人记录」Tab）
  - **When**: 页面加载完成
  - **Then**: 
    - 显示当前月份的日历
    - 每天的格子根据打卡状态显示不同颜色或标记（如：正常=绿色点，异常=红色点，缺卡=灰色点）
    - 点击某天，显示当天的打卡明细（上班/下班时间、地点）

- [ ] AC2: 月份切换
  - **Given**: 用户在日历视图
  - **When**: 点击「上个月」或「下个月」按钮
  - **Then**: 日历切换到对应月份，并重新加载该月的统计/记录数据

## Constraints

- **性能要求**：切换月份时数据加载时间 < 1秒。
- **UI风格**：保持 App 现有的设计风格，日历组件需适配移动端操作。
- **数据时效**：统计数据应为实时数据（或准实时，延迟 < 5分钟）。

## Out of Scope

- 点击统计数字跳转到具体的异常人员列表（本次仅展示统计数字，跳转功能作为 v2 需求）。
- 复杂的筛选功能（如按部门筛选统计）。
- 导出报表功能。

## Assumptions

- 现有 App 框架支持引入通用的 Calendar 组件（如 `react-native-calendars`）。
- 后端已有或可快速计算每日统计数据（基于现有的 Attendance 表）。
- "异常"定义：包括迟到、早退、缺卡、旷工。

## Metadata

- 规模：中
- 涉及模块：attendance, statistics
- 涉及端：App, Server
- 创建时间：2026-02-06
- 状态：待确认
