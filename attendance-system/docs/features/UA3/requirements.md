# Requirements: UA3 部门管理

## Overview

实现企业组织架构管理，支持多级部门树形结构，提供增删改查及拖拽排序功能。部门是人员归属和考勤统计的基础维度。

## User Stories

### Story 1: 部门维护
As a 管理员, I want 创建、编辑和删除部门, so that 维护企业的组织架构。

**Acceptance Criteria:**
- [ ] AC1: **新增部门**：需输入名称、上级部门（可选）。
- [ ] AC2: **编辑部门**：可修改名称、上级部门。
- [ ] AC3: **删除部门**：支持删除操作。
- [ ] AC4: **删除校验**：若部门下存在子部门或已关联员工，禁止删除并提示原因。
- [ ] AC5: **循环引用校验**：编辑上级部门时，禁止选择自己或自己的子部门作为父节点。

### Story 2: 部门树展示
As a 管理员, I want 以树形结构查看部门, so that 直观管理组织关系。

**Acceptance Criteria:**
- [ ] AC1: **树形展示**：左侧展示部门树，支持展开/折叠。
- [ ] AC2: **状态保持**：刷新页面后尽量保持之前的展开状态（可选，P2）。

### Story 3: 部门选择
As a 用户/管理员, I want 在人员管理等场景选择部门, so that 关联业务数据。

**Acceptance Criteria:**
- [ ] AC1: 提供部门树选择组件（TreeSelect）。
- [ ] AC2: 支持单选（人员归属）。
- [ ] AC3: 支持搜索部门名称。

## Constraints

- **数据完整性**：删除部门时必须进行强校验（子部门 + 员工）。
- **层级关系**：数据库需存储父子关系（Parent ID）和排序字段（Sort Order）。
- **性能**：部门树数据量通常不大（<1000），可一次性加载或按需加载。本期采用一次性加载全量树。

## Out of Scope

- 部门合并/拆分工具
- 部门编制管理
- 部门历史变更记录
- 虚拟团队/项目组（非行政部门）

## Assumptions

以下假设已与用户确认：
- 根节点可以是多个（森林结构），但在 UI 上通常虚拟一个“全公司”根节点。
- 部门层级深度一般不超过 10 层。
- 部门名称在同一父节点下唯一。

## Metadata

- 规格编号：UA3
- 涉及模块：department (Shared), user (Server)
- 涉及端：Server, Web
- 状态：待确认
