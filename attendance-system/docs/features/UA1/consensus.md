# 共识文档：UA1 用户管理与认证

## 概述
构建系统的用户基石，包括用户账号的增删改查（CRUD）管理功能，以及基于 JWT 的安全认证体系，支持 Web 端和 App 端的登录与会话保持。

## User Stories

### Story 1: 用户账号管理 (Web 管理员)
**As a** 系统管理员, **I want** 能够新增、修改、查询和禁用用户账号, **So that** 我可以维护系统的使用者名单。

**验收标准（AC）：**
- [ ] AC1: 能查看用户列表，支持分页和按用户名/姓名搜索。
- [ ] AC2: 能新增用户，需校验用户名唯一性，密码加密存储。
- [ ] AC3: 能编辑用户信息（姓名、角色、状态）。
- [ ] AC4: 能重置用户密码。
- [ ] AC5: 能禁用/启用用户账号（而非直接物理删除）。

### Story 2: 用户登录 (全端)
**As a** 系统用户, **I want** 使用账号密码登录系统, **So that** 我可以访问我的考勤数据。

**验收标准（AC）：**
- [ ] AC1: 输入正确账号密码成功登录，返回 Access Token。
- [ ] AC2: 输入错误账号或密码，提示明确的错误信息。
- [ ] AC3: 登录成功后自动跳转到首页/Dashboard。
- [ ] AC4: 禁用的账号无法登录。

### Story 3: 接口安全认证
**As a** 开发者, **I want** 所有业务接口都受 Token 保护, **So that** 防止未授权访问。

**验收标准（AC）：**
- [ ] AC1: 请求头携带有效 Token 可访问受保护接口。
- [ ] AC2: 未携带 Token 或 Token 无效/过期，返回 401 状态码。
- [ ] AC3: 包含 Token 生成、验证、解析的完整中间件逻辑。

## 约束条件
- **技术栈**：Prisma (MySQL), Express, JWT, bcrypt。
- **安全性**：密码必须哈希存储，Token 有效期（如 7 天）。
- **字段规范**：用户名只能包含字母数字，长度 4-20 位。

## 不做的事项
- 暂不支持 OAuth (微信/钉钉) 登录（后续迭代）。
- 暂不支持用户自助注册（仅管理员创建）。
- 暂不包含复杂的 RBAC 权限系统（仅区分 Admin/User）。
- 暂不处理 User 与 Employee 的强关联逻辑（UA2 处理）。

## 已确认的假设
- 初始管理员账号通过 Seed 脚本注入。
- 默认初始密码统一为 `123456`（创建时）。
- 用户状态包含：`ACTIVE` (正常), `DISABLED` (禁用)。
