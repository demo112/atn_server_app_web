# 三端职责定义

## 1. 总体架构

本系统采用 Monorepo 架构，包含 Server（后端）、Web（管理端）、App（移动端）三端，通过 Shared 包共享类型定义。各端职责边界清晰，互不干扰。

## 2. Server (后端服务)

**定位**: 数据中心与业务逻辑核心  
**技术栈**: Node.js, Express, TypeScript, Prisma, MySQL, Redis

**核心职责**:
- **API 服务**: 为 Web 和 App 提供统一的 RESTful API (`/api/v1/*`)。
- **数据管理**: 负责所有业务数据的持久化、事务处理和一致性维护。
- **核心逻辑**:
  - **考勤计算引擎**: 根据原始打卡记录、排班信息和考勤制度，自动计算出勤状态（正常/迟到/早退/缺勤）。
  - **权限验证**: 基于 JWT 的身份认证与 RBAC 权限控制。
- **后台任务**:
  - 定时执行每日/每月考勤统计任务。
  - 处理异步消息队列（如批量导入导出）。

## 3. Web (管理端)

**定位**: 企业管理与配置中心  
**技术栈**: React, TypeScript, Vite

**核心职责**:
- **系统配置**: 
  - 考勤制度设置（迟到规则、加班规则）。
  - 班次与时间段管理。
  - 排班管理（部门排班、人员排班）。
- **组织管理**: 人员档案录入、离职处理、部门架构调整。
- **考勤管理**: 
  - 考勤异常的审批与人工修正（补签、销假）。
  - 原始打卡数据的查询与监控。
- **数据报表**: 提供多维度的考勤统计报表（日报、月报）与可视化展示。
- **目标用户**: 系统管理员、HR、部门主管。

## 4. App (移动端)

**定位**: 员工自助服务终端  
**技术栈**: React Native, Expo, TypeScript

**核心职责**:
- **考勤打卡**: 
  - 采集 GPS/WiFi 信息进行打卡验证。
  - 防作弊校验与实时打卡反馈。
- **个人查询**: 
  - 查看个人排班日历。
  - 查询每日考勤明细与月度汇总。
- **自助申请**: 
  - 提交请假、出差、加班申请。
  - 提交补签申请。
- **消息通知**: 接收考勤异常提醒、审批结果通知。
- **目标用户**: 全体员工。

## 5. 交互边界

- **Server vs Client**: Server 仅提供数据 API，不包含任何 UI 渲染逻辑；Web/App 负责 UI 展示与交互逻辑。
- **Web vs App**: 
  - Web 侧重**管理与配置**（复杂操作，PC端）。
  - App 侧重**执行与个人查询**（便捷操作，移动端）。
- **Shared**: 三端共享 TypeScript 类型定义 (`DTO`, `Enum`, `Interface`)，确保前后端数据结构严格一致。