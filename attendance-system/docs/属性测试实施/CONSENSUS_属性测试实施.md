# CONSENSUS - 属性测试实施 (Web端)

## 1. 实施目标与验收标准
- **核心目标**: 在 Web 端建立属性测试能力，提升核心逻辑代码健壮性.
- **验收标准**:
  - `packages/web` 成功引入 `fast-check` 依赖.
  - 至少完成 3 个核心工具函数/Hooks 的属性测试用例.
  - CI 流水线能正确执行属性测试并报告结果.
  - 团队具备编写基础属性测试的能力 (通过文档/示例).

## 2. 技术方案
- **测试框架**: Vitest (现有) + fast-check (新增).
- **文件命名**: 保持 `*.test.ts` / `*.test.tsx` 规范，属性测试代码可与单元测试共存.
- **配置策略**:
  - 本地开发: `numRuns: 100` (兼顾速度).
  - CI 环境: `numRuns: 100` (保持一致，避免 CI 超时，必要时可增加).

## 3. 渐进式实施策略
- **Stage 1: 基础建设 (T1-T2)**
  - 安装依赖.
  - 配置 Vitest 支持 (如有必要).
  - 选取 1 个纯函数 (如日期处理或数据格式化) 进行 Pilot.
- **Stage 2: 核心覆盖 (T2-T3)**
  - 覆盖 `src/utils` 下的关键业务逻辑.
  - 覆盖 `src/hooks` 下的复杂状态逻辑.
- **Stage 3: 持续集成 (T4-T5)**
  - 确保 CI 流程稳定.
  - 建立文档和规范.

## 4. 风险与缓解
- **学习成本**: PBT 思维转变困难.
  - *缓解*: 提供详细的 "PBT vs Example-based" 对比示例.
- **执行时间**:
  - *缓解*: 严格控制 `numRuns`，将耗时的深层测试标记为 `slow` 或单独运行.

## 5. 下一步
- 进入 Architect 阶段，设计具体的目录结构和示例代码模式.
