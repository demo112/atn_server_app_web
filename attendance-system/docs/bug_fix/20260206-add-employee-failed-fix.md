# 添加人员操作失败修复记录

## 问题描述
- **现象**：在前端添加人员时，提示“操作失败”。
- **复现步骤**：
  1. 进入人员管理页面。
  2. 点击“添加人员”。
  3. 填写表单并提交。
  4. 界面提示“操作失败”。
- **影响范围**：所有涉及后端 API 调用的功能（因端口不通）。

## 设计锚定
- **所属规格**：UA2
- **原设计意图**：API 应监听在配置的端口（3000）上，以便前端（默认连接 3000）能访问。
- **当前偏离**：Server 端 `.env` 配置了 `PORT=3001`，且代码优先使用 `.env` 配置，导致 Server 启动在 3001 端口，而前端尝试连接 3000 端口失败。

## 根因分析
- **直接原因**：前端请求端口（3000）与后端监听端口（3001）不一致，导致连接拒绝。
- **根本原因**：`packages/server/.env` 文件配置了 `PORT=3001`，违反了项目规范（应为 3000）。`packages/server/src/index.ts` 代码逻辑优先读取环境变量，导致规范端口未生效。
- **相关代码**：`packages/server/src/index.ts`

## 修复方案
- **修复思路**：在 `index.ts` 中强制将端口设置为 3000，覆盖环境变量中的错误配置，以符合项目规范。同时输出警告日志。
- **改动文件**：`packages/server/src/index.ts`

## 验证结果
- [x] Server 启动日志显示端口为 3000。
- [x] API 接口（http://localhost:3000/api/v1/employees）可访问（返回 401 或预期响应，而非连接拒绝）。
- [x] 设计一致性确认：符合项目环境规范。

## 文档同步
- [ ] design.md：无需更新
- [ ] api-contract.md：无需更新

## 提交信息
fix(server): 强制设置 Server 端口为 3000 以修复前端连接失败问题
