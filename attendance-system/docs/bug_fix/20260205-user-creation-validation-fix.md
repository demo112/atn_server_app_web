# 用户创建校验失败修复记录

## 问题描述
- **现象**：添加用户时报错 `AxiosError: Request failed with status code 400`，界面提示"Validation failed"和"创建失败"。
- **复现步骤**：
  1. 进入用户管理页面
  2. 点击"添加"
  3. 输入用户名 "11"（少于3字符）或密码 "...."（少于6字符）
  4. 点击确定，报错。
- **影响范围**：用户管理模块（添加用户功能）。

## 设计锚定
- **所属规格**：UA1 (用户与权限)
- **原设计意图**：
  - Backend DTO (`user.dto.ts`) 强制要求用户名最少3字符，密码最少6字符。
  - 前端应配合后端规则进行校验，提供即时反馈。
- **当前偏离**：
  - 前端 `UserModal` 缺失校验逻辑，允许提交非法数据。
  - `UserList` 错误处理冗余，未正确展示后端具体的校验错误信息。

## 根因分析
- **直接原因**：用户输入不符合后端 `zod` schema 定义的规则 (`min(3)`, `min(6)`)。
- **根本原因**：
  1. 缺失客户端校验，导致非法请求直接发送给后端。
  2. 错误处理机制不完善，`UserList` 的 catch 块覆盖了全局拦截器的具体错误提示。

## 修复方案
- **修复思路**：
  1. 在 `UserModal` 中增加与后端一致的校验逻辑（用户名>=3，密码>=6）。
  2. 优化 `UserList` 的错误处理，对于 Axios 错误（已被全局拦截器处理）不再弹出冗余的通用错误提示。
- **改动文件**：
  - `packages/web/src/pages/user/components/UserModal.tsx`: 增加 `validate` 函数和 UI 错误提示。
  - `packages/web/src/pages/user/UserList.tsx`: 移除对 `AxiosError` 的冗余 toast。

## 验证结果
- [x] 原问题已解决：前端会拦截非法输入，提示"用户名至少需要3个字符"或"密码至少需要6个字符"，不会发送 400 请求。
- [x] 回归测试通过：代码逻辑检查通过。
- [x] 设计一致性确认：符合 UA1 及后端 DTO 约束。

## 文档同步
- [ ] design.md：无需修改（属于实现细节补全）。
- [ ] api-contract.md：无需修改。

## 提交信息
fix(web): 增加用户创建表单校验及优化错误提示
