# 网络连接拒绝错误修复记录

## 问题描述
- **现象**：前端控制台大量报错 `net::ERR_CONNECTION_REFUSED` 和 `AxiosError: Network Error`，无法访问 API。
- **复现步骤**：启动前端后，访问任何需要 API 的页面。
- **影响范围**：所有涉及后端数据交互的功能。

## 设计锚定
- **所属规格**：环境配置
- **原设计意图**：
  - 后端服务监听在端口 3000 (参考 `.env.example` 和 `06-开发实施指南.md`)。
  - 前端开发服务器通过代理将 `/api` 请求转发到后端。
- **当前偏离**：
  - `packages/web/vite.config.ts` 中代理目标错误地配置为 `http://localhost:3001`。
  - 后端服务未运行。
  - 前端服务未运行（端口 5173 未监听）。

## 根因分析
- **直接原因**：前端请求被发送到了错误的端口（3001），且前后端服务均未正常运行。
- **根本原因**：配置漂移（Config Drift）和环境未就绪。
- **相关代码**：`packages/web/vite.config.ts:22`

## 修复方案
- **修复思路**：修正代理配置，确保前后端端口一致，并启动所有必要服务。
- **改动文件**：
  - `packages/web/vite.config.ts`: 将代理目标改为 `http://localhost:3000`。
- **操作**：
  - 启动后端服务 (`npm run dev` in `packages/server`)。
  - 启动前端服务 (`npm run dev` in `packages/web`)。

## 验证结果
- [x] 原问题已解决：
  - 前端服务 (5173) 可访问。
  - 后端服务 (3000) 可访问。
  - 代理转发正常，API 返回 `ERR_AUTH_MISSING_TOKEN`。
- [x] 回归测试通过：API 连通性测试通过。
- [x] 设计一致性确认：端口配置已回归设计文档约定。

## 文档同步
- [ ] design.md：无需更新。
- [ ] api-contract.md：无需更新。

## 提交信息
fix(env): 修正前端代理端口并启动服务

背景: 前端无法连接后端，报连接拒绝错误
变更: 将 vite.config.ts 中的代理目标从 3001 改为 3000
影响: 恢复开发环境下的 API 连通性
